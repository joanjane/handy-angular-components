<div class="hac-dd">
    <div class="hac-dd-label" 
        (click)="openDropdown($event)">
        <input 
            type="text" class="hac-dd-filter" [placeholder]="placeholder"
            id="{{id}}"
            [(ngModel)]="filter"
            [readonly]="!filtrable || disabled"
            (keyup)="handleKey($event)"
            (focus)="openDropdown($event)"
            (focusOut)="closeDropdown($event)"
            autocomplete="off"
        />

        <i class="hac-icon-chevron" [ngClass]="{'hac-icon-chevron--up': !collapsed}" (click)="toggleDropdown($event)" aria-hidden="true"></i>
    </div>

    <div class="hac-dd-list" 
        [ngClass]="{ 'hac-dd-list--is-collapsed': collapsed }" 
        *ngIf="hasGroups()"
        [hacCopyWidth]="getLabelElem()"
        widthCssProperty="width"
        [skip]="collapsed"
        [style.maxHeight]="calcDropdownHeight()">

        <div class="hac-dd-option" *ngIf="allowEmpty" (click)="select(null)">{{placeholder}}</div>
        <div class="hac-dd-group" *ngFor="let group of optionGroups">
            <div class="hac-dd-grouplabel" *ngIf="group.label">{{group.label}}</div>
            <div class="hac-dd-optgroup">
                <div class="hac-dd-optrow" *ngFor="let optionRow of group.options | hacDropdownFilter: filter : shouldApplyFilter() | hacDropdownColumnizer: columns"
                    [ngClass]="{'hac-dd-optrow--multiple-col': columns !== 1}">
                    <div *ngFor="let option of optionRow" 
                        (click)="select(option.key)" class="hac-dd-option hac-dd-choice" 
                        [ngClass]="{ 
                            'hac-dd-option--is-selected': option.key === selected }">
                        {{option.label}}
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</div>